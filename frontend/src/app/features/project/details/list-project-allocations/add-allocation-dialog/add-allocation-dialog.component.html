<ng-container *ngIf="userOptions$ | async as users; else loading">
    <h1 mat-dialog-title>Alocar usuário</h1>
    <div mat-dialog-content [formGroup]="form">
        <app-autocomplete-users [formControl]="autocomplete" (selected)="onSelect($event)" [users]="users">
            <span slot="mat-label">-- SELECIONE --</span>
        </app-autocomplete-users>

        <div class="container-fields">
            <mat-form-field class="maximize" appearance="outline">
                <mat-label>Responsabilidade</mat-label>
                <mat-select formControlName="responsability">
                    <mat-option *ngFor="let responsability of responsabilityOptions" [value]="responsability">
                        {{ responsability }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
    
            <mat-form-field class="maximize" appearance="outline">
                <mat-label>Usuário</mat-label>
                <input *ngIf="user.value as user; else noUser" matInput value="{{ user.name }} #{{ user.id }}" readonly>
                <ng-template #noUser>
                    <input matInput readonly>
                </ng-template>
            </mat-form-field>
        </div>
    </div>
    <div mat-dialog-actions>
        <button mat-raised-button color="primary" class="font-white"
            (click)="onSave()" [disabled]="form.invalid">
            Salvar
        </button>
        <button mat-button mat-dialog-close>Cancelar</button>
    </div>
</ng-container>

<ng-template #loading>
    <div class="loading-spinner">
        <mat-spinner></mat-spinner>
    </div>
</ng-template>
